<complete Source.cpp code as provided>